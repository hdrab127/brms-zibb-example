<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Paul BÃ¼rkner, Hayden Rabel" />

<meta name="date" content="2022-03-16" />

<title>Define Custom Response Distributions with brms</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Define Custom Response Distributions with brms</h1>
<h4 class="author">Paul BÃ¼rkner, Hayden Rabel</h4>
<h4 class="date">2022-03-16</h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#a-case-study">A Case Study</a></li>
<li><a href="#reparameterising-the-log-normal">Reparameterising the Log-normal</a></li>
<li><a href="#fitting-custom-family-models">Fitting Custom Family Models</a></li>
<li><a href="#post-processing-custom-family-models">Post-Processing Custom Family Models</a></li>
<li><a href="#turning-a-custom-family-into-a-native-family">Turning a Custom Family into a Native Family</a></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The <strong>brms</strong> package comes with a lot of built-in response distributions â usually called <em>families</em> in R â to specify among others linear, count data, survival, response times, or ordinal models (see <code>help(brmsfamily)</code> for an overview). Despite supporting over two dozen families, there is still a long list of distributions, which are not natively supported. The present vignette will explain how to specify such <em>custom families</em> in <strong>brms</strong>. By doing that, users can benefit from the modelling flexibility and post-processing options of <strong>brms</strong> even when using self-defined response distributions.</p>
<p>If you have built a custom family that you want to make available to other users, you can submit a pull request to this <a href="https://github.com/paul-buerkner/custom-brms-families">GitHub repository</a>.</p>
<p>A previous version of this vignette that illustrated how to define the Beta-binomial <em>custom family</em> in <strong>brms</strong> is available here (ADD LINK TO OLD?).</p>
</div>
<div id="a-case-study" class="section level2">
<h2>A Case Study</h2>
<p>Suppose we are interested in predicting variability of ocean acidity around New Zealand, and how it might change during climate phases of <a href="https://niwa.co.nz/climate/information-and-resources/elnino">El NiÃ±o and La NiÃ±a</a>. First we can load the <strong>brms</strong> dataset <code>nzocean</code>, and note the following variables of interest:</p>
<ul>
<li><code>pco2</code>: Ocean acidity, partial CO<sub>2</sub> in Î¼atm.</li>
<li><code>phase</code>: El NiÃ±o Southern Oscillation phase.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;nzocean&#39;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remove fluctuating phase to just look at stable enso periods</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>nzocean <span class="ot">&lt;-</span> nzocean[nzocean<span class="sc">$</span>phase <span class="sc">!=</span> <span class="st">&#39;Fluctuating&#39;</span>, ]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># and drop missing pco2 rows (link to missing values vignette?)</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>nzocean <span class="ot">&lt;-</span> nzocean[<span class="sc">!</span><span class="fu">is.na</span>(nzocean<span class="sc">$</span>pco2), ]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nzocean, <span class="at">n =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>          date temp    sal  pco2   dioc    pH   soi   phase
1   1998-01-20 10.5 34.268 348.8 2084.5 8.095 -2.34 El NiÃ±o
2   1998-02-16 12.9 34.294 351.8 2058.3 8.091 -1.73 El NiÃ±o
3   1998-03-17 12.0 34.255 340.8 2061.2 8.103 -2.77 El NiÃ±o
10  1998-10-05  8.6 34.324 366.1 2102.6 8.074  1.07 La NiÃ±a
11  1998-10-21  9.2 34.297 363.4 2084.1 8.075  1.07 La NiÃ±a
12  1998-11-16 10.3 34.263 370.8 2086.1 8.070  1.14 La NiÃ±a
31  2000-06-01 10.3 34.300 369.6 2100.4 8.074 -0.46 Neutral
69  2003-08-12  7.7 34.238 360.5 2115.5 8.081 -0.14 Neutral
71  2003-10-15  8.8 34.408 364.1 2109.4 8.078 -0.18 Neutral
115 2007-04-02 11.6 34.285 354.4 2079.0 8.089 -0.14 Neutral</code></pre>
<p>Now after some <a href="https://bookdown.org/content/4857/big-entropy-and-the-generalized-linear-model.html#rethinking-the-scourge-of-histomancy.">histomancy</a> we might assume that observations of ocean acidity (<code>pco2</code>), <span class="math inline">\(y \in \mathbb{R}^+\)</span>, are generated from some Log-normal distribution, with mean, <span class="math inline">\(\mu \in \mathbb{R}\)</span>, and standard deviation, <span class="math inline">\(\sigma\in \mathbb{R}^+\)</span>.</p>
<p>The Log-normal model included in <strong>brms</strong> and <a href="https://mc-stan.org/docs/2_29/functions-reference/lognormal.html">Stan</a> uses the log-scale parameterisation with the probability distribution function:</p>
<p><span class="math display">\[
P(y | \mu, \sigma) = 
\frac{1}{\sqrt{2\pi}\sigma}
\frac{1}{y}
\exp\left[
-\frac{1}{2}\left(\frac{\ln y - \mu}{\sigma}\right)^2
\right].
\tag{1}
\]</span></p>
<p>This effectively says, we suspect that the logarithm, <span class="math inline">\(n\)</span>, of the random variable <span class="math inline">\(y\)</span>, follows a normal distribution. I.e.,</p>
<p><span class="math display">\[
\begin{aligned}
y &amp;\sim \text{Lognormal}(\mu, \sigma)\\
&amp;\implies\\
n = \ln y &amp;\sim \text{Normal}(\mu_n, \sigma_n),\\
\end{aligned}
\tag{2}
\]</span></p>
<p>where the parameters</p>
<p><span class="math display">\[
\begin{aligned}
\mu_n &amp;= \exp\left(\mu + \frac{\sigma^2}{2}\right),~\text{and}\\
\sigma_n &amp;= \exp\left(\mu + \frac{\sigma^2}{2}\right)
\sqrt{\exp(\sigma ^ 2) - 1}
\end{aligned}
\tag{3}
\]</span></p>
<p>are said to be on the <em>natural-scale</em> of <span class="math inline">\(y\)</span> (or <code>pco2</code>).</p>
<p>This model offers a bunch of nice properties, such as ensuring <span class="math inline">\(y\)</span> is strictly positive, and allowing response shapes from near-symmetric, small <span class="math inline">\(\sigma\)</span>, to more right-skewed as <span class="math inline">\(\sigma\)</span> increases. Equations 2 &amp; 3 also provide us a method to transform the parameters, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, back to the natural scale of <code>pco2</code>.</p>
<p>Now to predict <code>pco2</code>âs distribution using <code>phase</code>, we can try a simple model that assumes each phase corresponds to different posterior distributions of <span class="math inline">\(\mu_y\)</span> and <span class="math inline">\(\sigma_y\)</span>, i.e., by varying intercepts,</p>
<p><span class="math display">\[
\begin{aligned}
pco2_i &amp;\sim \text{Lognormal}(\mu_i, \sigma_i) \\
\mu_i &amp;= \alpha_{phase[i]} \\
\log \sigma_i &amp;= \beta_{phase[i]}
\end{aligned}
\tag{4}
\]</span></p>
<p>Note two things in this equation:</p>
<ul>
<li>The linear predictor for <span class="math inline">\(\sigma\)</span> is linked via the <code>log</code> function for strictly positive results and model efficiency (see <code>vignette(&quot;brms_overview&quot;)</code> for more details on links and linear predictors in <strong>brms</strong>).</li>
<li>The priors for <span class="math inline">\(\alpha_j\)</span> and <span class="math inline">\(\beta_j\)</span> have not been specified â we will use the default <strong>brms</strong> flat priors for these intercept parameters as the main focus is on the Log-normal distribution family. For a proper analysis, one might want to centre and scale <code>pco2</code> then define some <a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations">slightly more informative priors</a>.</li>
</ul>
<p>In <strong>brms</strong> this model is coded as:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fit_ln <span class="ot">&lt;-</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="fu">bf</span>(pco2 <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> phase, sigma <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> phase),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> nzocean,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">0</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">lognormal</span>(<span class="at">link =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">link_sigma =</span> <span class="st">&#39;log&#39;</span>))</span></code></pre></div>
<p>In the summary output, we see that the population level estimates for each <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are much lower than the observed sample mean of 368 <span class="math inline">\(\mu\text{atm}\)</span>, and standard deviation of 14, respectively. This is due to <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> being on the log-scale in <code>brms::lognormal</code>, and the negative <span class="math inline">\(\sigma\)</span> values indicate these values are for itâs log-linked linear predictor. To get these on the same scale as <code>pco2</code>, we would need to first inverse the <span class="math inline">\(\sigma\)</span> estimates with <code>exp</code> then apply the transformations in equation 3 above.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_ln)</span></code></pre></div>
<pre><code> Family: lognormal 
  Links: mu = identity; sigma = log 
Formula: pco2 ~ 0 + phase 
         sigma ~ 0 + phase
   Data: nzocean (Number of observations: 30) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                   Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
phaseNeutral           5.92      0.01     5.90     5.95 1.00     5044     2621
phaseLaNiÃ±a            5.89      0.01     5.87     5.91 1.00     4389     2869
phaseElNiÃ±o            5.89      0.03     5.84     5.94 1.00     3275     2104
sigma_phaseNeutral    -3.34      0.21    -3.72    -2.89 1.00     4100     2684
sigma_phaseLaNiÃ±a     -3.43      0.22    -3.82    -2.97 1.00     4401     2642
sigma_phaseElNiÃ±o     -2.91      0.35    -3.50    -2.12 1.00     3224     2067

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>While applying these transformations for simple estimates may seem okay at first, when it comes to measures of uncertainty and any posterior summaries it may mean having to re-write or add a lot of messy code. For instance, plotting the posterior densities of each <span class="math inline">\(\sigma_{phase}\)</span> estimate is usually as concise as:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_ln, <span class="at">variable =</span> <span class="st">&#39;sigma&#39;</span>, <span class="at">regex =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># invert the log-link function</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&#39;exp&#39;</span>, <span class="at">labels =</span> <span class="cf">function</span>(l) <span class="fu">round</span>(<span class="fu">exp</span>(l), <span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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iciHbcMwBuPeG2scu7Pv0d7OP+9upTYLY9jO3gAcNMu/lV/EzN3/30wP2WZhDJqfxqfqt2tlTM3dHq7yMK6TiYX3JN89C8/NtSeVP587/5nfLH/6h+LcrRQzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNgrjIZMwzmKpMxw2CuMhkzDOYqkzHDYK4yGTMM5iqTMcNg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" width="60%" style="display: block; margin: auto;" /></p>
<p>but to get this on the same scale as <code>pco2</code> we would need to reproduce the code for <code>mcmc_plot</code> and insert our transformations since posterior draws for each <span class="math inline">\(\sigma_{phase}\)</span> on the natural-scale are dependent on their associated <span class="math inline">\(\mu_{phase}\)</span> (equation 3).</p>
</div>
<div id="reparameterising-the-log-normal" class="section level2">
<h2>Reparameterising the Log-normal</h2>
<p>To make potentially more intuitive inferences on the mean and variance of <code>pco2</code> without too much code, we could reparameterise the Log-normal distribution to use the natural-scale parameters <span class="math inline">\(\mu_n\)</span> and <span class="math inline">\(\sigma_n\)</span> directly. This yields the same formula as in equation 1,</p>
<p><span class="math display">\[
P(y | \mu_n, \sigma_n) = 
\frac{1}{\sqrt{2\pi}\sigma}
\frac{1}{y}
\exp\left[
-\frac{1}{2}\left(\frac{\ln y - \mu}{\sigma}\right)^2
\right],
\tag{5}
\]</span></p>
<p>except now <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are expressed in terms of <span class="math inline">\(\mu_n\)</span> and <span class="math inline">\(\sigma_n\)</span> by reversing equation 3:</p>
<p><span class="math display">\[
\begin{aligned}
\mu &amp;= \ln\left(\frac{\mu_n}{\sqrt{1 + \sigma_n^2/\mu^2_n}}\right),\\
\sigma &amp;= \sqrt{\ln\left(1 + \frac{\sigma_n^2}{\mu^2_n}\right)}.\\
\end{aligned}
\tag{6}
\]</span></p>
<p>Letâs call this reparameterisation <a href="https://en.wikipedia.org/wiki/Log-normal_distribution#:~:text=LogNormal7(%CE%BCN%2C%CF%83N)%20with%20mean%2C%20%CE%BCN%2C%20and%20standard%20deviation%2C%20%CF%83N%2C%20both%20on%20the%20natural%20scale"><strong>lognormal7</strong></a>.</p>
</div>
<div id="fitting-custom-family-models" class="section level2">
<h2>Fitting Custom Family Models</h2>
<p>The lognormal7 distribution is not natively supported in <strong>brms</strong> and so we will have to define it ourselves using the <code>custom_family</code> function. This function requires the familyâs name, the names of its parameters (<code>mu</code> and <code>sigma</code> in our case), corresponding link functions (only applied if parameters are predicted), their theoretical lower and upper bounds (only applied if parameters are not predicted), information on whether the distribution is discrete or continuous, and finally, whether additional non-parameter variables need to be passed to the distribution. For our lognormal7 example, this results in the following custom family:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>lognormal7 <span class="ot">&lt;-</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">custom_family</span>(<span class="at">name =</span> <span class="st">&#39;lognormal7&#39;</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">dpars =</span> <span class="fu">c</span>(<span class="st">&#39;mu&#39;</span>, <span class="st">&#39;sigma&#39;</span>),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># log links to prevent underflow</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">links =</span> <span class="fu">c</span>(<span class="st">&#39;log&#39;</span>, <span class="st">&#39;log&#39;</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">lb =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">&#39;real&#39;</span>)</span></code></pre></div>
<p>Next, we have to provide the relevant <strong>Stan</strong> functions if the distribution is not defined in <strong>Stan</strong> itself. For the <code>lognormal7</code> distribution, this is straight forward since the log-scale <code>lognormal</code> distribution is already implemented <a href="https://mc-stan.org/docs/2_29/functions-reference/lognormal.html">here</a>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>stan_funs <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="st">  // see transformations in equation (6):</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="st">  real mu_ln(real mu_n, real sigma_n) {</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">    return log(mu_n / sqrt(1 + sigma_n ^ 2 / mu_n ^ 2));</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="st">  real sigma_ln(real mu_n, real sigma_n) {</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="st">    return sqrt(log(1 + sigma_n ^ 2 / mu_n ^ 2));</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="st">  // log-probability distribution</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="st">  real lognormal7_lpdf(real y, real mu_n, real sigma_n) {</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="st">    return lognormal_lpdf(y | mu_ln(mu_n, sigma_n), sigma_ln(mu_n, sigma_n));</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="st">  // random number generator</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="st">  real lognormal7_rng(real mu_n, real sigma_n) {</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="st">    return lognormal_rng(mu_ln(mu_n, sigma_n), sigma_ln(mu_n, sigma_n));</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>)</span></code></pre></div>
<p>For the model fitting, we will only need <code>lognormal7_lpdf</code>, but <code>lognormal7_rng</code> will come in handy when it comes to post-processing (we could use <code>stats::rlnorm</code> but using the Stan random number generator will be more generalisable for other distributions not built in to R).</p>
<p>The code for these functions is added to the correct block of <strong>Stan</strong> code by:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>stanvars <span class="ot">&lt;-</span> <span class="fu">stanvar</span>(<span class="at">scode =</span> stan_funs, <span class="at">block =</span> <span class="st">&quot;functions&quot;</span>)</span></code></pre></div>
<p>Then we have all components together to fit our custom <code>lognormal7</code> model:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fit_ln7 <span class="ot">&lt;-</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="fu">bf</span>(pco2 <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> phase, sigma <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> phase),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> nzocean,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">0</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> lognormal7,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars)</span></code></pre></div>
<p>The estimates in the summary output are still on a log-scale, except that this time only the <code>exp</code> inverse link function is required:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_ln7)</span></code></pre></div>
<pre><code> Family: lognormal7 
  Links: mu = log; sigma = log 
Formula: pco2 ~ 0 + phase 
         sigma ~ 0 + phase
   Data: nzocean (Number of observations: 30) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                   Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
phaseNeutral           5.93      0.01     5.91     5.95 1.00     4241     2532
phaseLaNiÃ±a            5.90      0.01     5.88     5.92 1.00     4467     2822
phaseElNiÃ±o            5.90      0.03     5.84     5.95 1.00     2656     1944
sigma_phaseNeutral     2.59      0.22     2.20     3.06 1.00     4305     2514
sigma_phaseLaNiÃ±a      2.47      0.23     2.07     2.95 1.00     3842     2774
sigma_phaseElNiÃ±o      2.98      0.35     2.42     3.78 1.00     2955     2361

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Now we can visualise uncertainties now in terms of <code>pco2</code> standard deviations for each El NiÃ±o phase via the same code as before</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_ln7, <span class="at">variable =</span> <span class="st">&#39;sigma&#39;</span>, <span class="at">regex =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># invert the log-link function</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&#39;exp&#39;</span>, <span class="at">labels =</span> <span class="cf">function</span>(l) <span class="fu">round</span>(<span class="fu">exp</span>(l), <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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uSfTs87KR5Fz39yoksRFT+my+rs+qP8XGLzH1uJjTbrHy88IkPv4xepHkXPfXOVeZvRCugzX4urUf6mzfPDuxMcat9MDDiqvwp987tObf/nP5Y9yzn1jlXuZyZdX28p9/Mfaf4Cln+5Ueixg7pNueBXeqX9UcO4bq9zLDHraTXb5uz795rz6C0s/3an8sYrcWTcz/3cxfwum/Chx7hsr72XS/eB2cr+un+T6fbxOrT0W89591l/8bdWvfrPEuW+qci9TvAtf+67TvSx+1wf1O/XBe7xxLx5rekZ8ZyZ/e3Xpo5lz31z1fZn08y1c3a/jt/ym/7641Nd/ulOLx6K9754bld+8q37fzrlvqriXuZm/9BFyn357kK445fdq01lXv3W7O+VjhQv78DZd3Itp82f3RI3bzy9nv35+Xv1ox9OAuc/vZbaQ+6gIbX5P1MvPWvnpzlUfa3qRtb6OV8B82ui9/ZHbjelZuMt88T+1j3Y8DZi72TrO3faIc7c94txtjzh32yPO3faIc7c94txtjzh32yPO3faIc7c94txtjzh32yPO3faIc7c94txtj/w/veaLCo5rdBcAAAAASUVORK5CYII=" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="post-processing-custom-family-models" class="section level2">
<h2>Post-Processing Custom Family Models</h2>
<p>Some post-processing methods such as <code>summary</code> or <code>mcmc_plot</code> work out of the box for custom family models. However, there are three particularly important methods, which require additional input by the user. These are <code>posterior_epred</code>, <code>posterior_predict</code> and <code>log_lik</code> computing predicted mean values, predicted response values, and log-likelihood values, respectively. They are not only relevant for their own sake, but also provide the basis of many other post-processing methods. For instance, we may be interested in comparing the fit of the log-scale model with that of the natural-scale model by means of approximate leave-one-out cross-validation implemented in method <code>loo</code>, which in turn requires <code>log_lik</code> to be working.</p>
<p>The <code>log_lik</code> function of a family should be named <code>log_lik_&lt;family-name&gt;</code> and have the two arguments <code>i</code> (indicating observations) and <code>prep</code>. You donât have to worry too much about how <code>prep</code> is created (if you are interested, check out the <code>prepare_predictions</code> function). Instead, all you need to know is that parameters are stored in slot <code>dpars</code> and data are stored in slot <code>data</code>. Generally, parameters take on the form of a <span class="math inline">\(S \times N\)</span> matrix (with <span class="math inline">\(S =\)</span> number of posterior draws and <span class="math inline">\(N =\)</span> number of observations) if they are predicted (as in our example) and a vector of size <span class="math inline">\(N\)</span> if the are not predicted.</p>
<p>We could define the complete log-likelihood function in R directly, or we can expose the self-defined <strong>Stan</strong> functions and apply them. The latter approach is usually more convenient, but the former is more stable and the only option when implementing custom families in other R packages building upon <strong>brms</strong>. For the purpose of the present vignette, we will go with the latter approach.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">expose_functions</span>(fit_ln7, <span class="at">vectorize =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Then define the required <code>log_lik</code> function with a few lines of code.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>log_lik_lognormal7 <span class="ot">&lt;-</span> <span class="cf">function</span>(i, prep) {</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> prep<span class="sc">$</span>dpars<span class="sc">$</span>mu[, i]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> prep<span class="sc">$</span>dpars<span class="sc">$</span>sigma[, i]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> prep<span class="sc">$</span>data<span class="sc">$</span>Y[i]</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lognormal7_lpdf</span>(y, mu, sigma)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The <code>get_dpar</code> function will do the necessary transformations to handle both the case when the distributional parameters are predicted separately for each row and when they are the same for the whole fit.</p>
<p>With that being done, all of the post-processing methods requiring <code>log_lik</code> will work as well. For instance, model comparison can simply be performed via</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo</span>(fit_ln, fit_ln7)</span></code></pre></div>
<pre><code>Output of model &#39;fit_ln&#39;:

Computed from 4000 by 30 log-likelihood matrix

         Estimate  SE
elpd_loo   -123.7 3.5
p_loo         4.5 0.9
looic       247.5 7.0
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     29    96.7%   1249      
 (0.5, 0.7]   (ok)        1     3.3%   376       
   (0.7, 1]   (bad)       0     0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)  0     0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_ln7&#39;:

Computed from 4000 by 30 log-likelihood matrix

         Estimate  SE
elpd_loo   -123.9 3.5
p_loo         4.6 1.0
looic       247.8 7.0
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     28    93.3%   982       
 (0.5, 0.7]   (ok)        2     6.7%   633       
   (0.7, 1]   (bad)       0     0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)  0     0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
        elpd_diff se_diff
fit_ln   0.0       0.0   
fit_ln7 -0.2       0.1   </code></pre>
<p>Since larger <code>ELPD</code> values indicate better fit, this would suggest that the log-scale lognormal model fits ever-so-slightly better. Though, given these two models are just different parameterisations of the same underlying distribution, this difference is likely just noise introduced by different sampling efficiencies.</p>
<p>Next, we will define the function necessary for the <code>posterior_predict</code> method:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>posterior_predict_lognormal7 <span class="ot">&lt;-</span> <span class="cf">function</span>(i, prep, ...) {</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> prep<span class="sc">$</span>dpars<span class="sc">$</span>mu[, i]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> prep<span class="sc">$</span>dpars<span class="sc">$</span>sigma[, i]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lognormal7_rng</span>(mu, sigma)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The <code>posterior_predict</code> function looks pretty similar to the corresponding <code>log_lik</code> function, except that we are now creating random draws of the response instead of log-likelihood values. Again, we are using an exposed <strong>Stan</strong> function for convenience. Make sure to add a <code>...</code> argument to your <code>posterior_predict</code> function even if you are not using it, since some families require additional arguments. With <code>posterior_predict</code> to be working, we can engage for instance in posterior-predictive checking:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fit_ln7) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Posterior predictions of all pco2&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fit_ln7, <span class="at">type =</span> <span class="st">&#39;dens_overlay_grouped&#39;</span>, <span class="at">group =</span> <span class="st">&#39;phase&#39;</span>) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Posterior predictions of pco2 for each phase&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<p>When defining the <code>posterior_epred</code> function, you have to keep in mind that it has only a <code>prep</code> argument and should compute the mean response values for all observations at once. Since the expected value of the <code>lognormal7</code> distribution on the natural scale is simply itâs mean, <span class="math inline">\(\text{E}(y) = \mu\)</span>, the definition of the corresponding <code>posterior_epred</code> function is straightforward:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>posterior_epred_lognormal7 <span class="ot">&lt;-</span> <span class="cf">function</span>(prep) {</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  prep<span class="sc">$</span>dpars<span class="sc">$</span>mu</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>A post-processing method relying directly on <code>posterior_epred</code> is <code>conditional_effects</code>, which allows to visualize effects of predictors.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">conditional_effects</span>(fit_ln7), </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">points =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">point_args =</span> <span class="fu">list</span>(<span class="at">col =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAu4AAAJYCAMAAAAKUJOQAAABtlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYzMzM6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtNTU1NTW5NTY5Nbo5NbqtNjshmAABmADpmAGZmOgBmOjpmOmZmZjpmZpBmZrZmkGZmkJBmkLZmkNtmtttmtv9uTU1uTW5uTY5ubk1ubm5ubo5ujqtujshuq8huq+SOTU2OTY6Obk2Obm6Obo6Ojm6OjquOq8iOq+SOyOSOyP+QOgCQOmaQZjqQZraQkGaQtraQttuQtv+Q27aQ2/+rbk2rbm6rbo6rbqurjk2rjm6rq+SryKuryOSr5Mir5OSr5P+2ZgC2Zjq2Zma2kDq2kGa2kJC2tpC2tra2ttu229u22/+2/9u2///Ijk3Ijm7Ijo7Iq27Iq47Iq6vIq8jIyI7I5OTI5P/I/+TI///bkDrbkGbbtmbbtpDbtrbbttvb27bb29vb2//b/7bb///fU2vkq27kq47kyI7kyKvk5Kvk5P/k/8jk/+Tk////tmb/tpD/yI7/yKv/25D/27b/29v/5Kv/5Mj/5OT//7b//8j//9v//+T///+OQUerAAAACXBIWXMAABcRAAAXEQHKJvM/AAAXxklEQVR4nO3d/2Mb9X3HcSWEEW9AR8bJJNnK6Fa+GAqYeClbqDM26KpudGPYdGxsGXZhdJmzZF8jNxmrPDdBIbbuP9597qRYss+WJX8+utd93s/HD7GcmPO9dU8fp9NJbqSAGY2qVwCYHXKHIeQOQ8gdhpA7DCF3GELuMITcYQi5wxByhyHkDkMC5M5PEFSROwwhdxhC7jCE3GEIucMQcoch5A5DyB2GkDsMIXcYQu4whNxhCLnDEHKHIeQOQ8gdhpA7DIkp93amqu+NWogo93ab3nG0CdvsLiy7D731JFnsjN6adpG+tNv0jjEma7PXSvLc1853eh9cGL015SJ9abfpHeNM1ub2Qp77dnOlv6PfuzXtIn0hd4w3UZs7b/88zz3bpbs9/YXhW1Mu0htyx3gTtbm+vO1y31kqjmPmN/ZuTbtIb8gd403S5vZimufeXbjkPt1sruzdyr/gbI6HqlA1QZs7b2+MyX3iRXpF7RhngjY33UPTodyzQ5i9W9Mt0i9qxxjHb7O7mPZzlzx2B8Y7fpubSaG50msNzsfs3ZpqkcBsTdjmtux5d2C8qXLPduedB/kufe/W1IsEZmaq3N2VMs0rndFb0y4SmJmIrogExiF3GELuMITcYQi5wxByhyHkDkPIHYaQOwwhdxhC7jCE3GEIucMQcoch5A5DyB2GkDsMIXcYQu4whNxhCLnDEHKHIeQOQ8gdhpA7DCF3GELuMITcYQi5wxByhyHkDkPIHYaQOwwhdxhC7jCE3GEIucMQcoch5A5DyB2GkDsMIXcYQu4whNxhCLnDEHKHIeQOQ8gdhpA7DCF3GELuMITcYQi5wxByhyHkDkPIHYaQOwwhdxhC7jCE3GFITLm3M1V9b9RCRLm32/SOo8WTe7tN7xgjmtzbbXrHOOQOQ8gdhpA7DIkmdx6qYrx4cudEJMaKKHeeZsI4MeUOjBFT7uzdMUZEuXPsjnHiyZ0zMxgrmtw5747xyB2GkDsMIXcYEk3uPFTFePHkzolIjBVR7jzNhHFiyh0Yg9xhCLnDEHKHIeQOQ8gdhpA7DCF3GELuMITcYQi5wxByhyHkDkPIHYaQOwwhdxhC7jCE3GEIucMQcoch5A5DyB2GkDsMIXcYQu4whNxhCLnDEHKHIeQOQ8gdhpA7DCF3GELuMITcYQi5wxByhyHkDkPIHYaQOwwhdxhC7jCE3GEIucMQcoch5A5DyB2GkDsMIXcYQu4wpGa5N04k4IqZV48NQ+7woh4bpma5j/nOBK1JZsOQO8KT2TDkjvBkNgy5IzyZDUPuCE9mw5A7wpPZMOSO8GQ2DLkjPJkNQ+4IT2bDkDvCk9kw5I7g2o1Gu+p1KJA7Qmu73DV6J3cE1i5yl+h9kkC6l5PmO/mtB5eT5LkVd6u3niSLnakX6Re5C2oPclfofYJAulc6vc+TZXdr4a1Oeqfpel873+l9cGHaRXpG7oJqmnvvS/dHy6W9eb7jbl5K023XfHdhebpF+kbugmqaey5vPN10kfday/nOffAzMO0iPSJ3QXXOvbuY/7nQ/DDdzG7uLOWhr81vTL9Ij8hdUV0fqqa9O69+mN/oLiSvf5h/dDv7Ym+fOZsjd4yo6YnInaUkSfK+0ztJ4g5j9uU++SL9IndNdX2a6Zv1JD9u2VzsrSfPbQxy52AGR5LZMJOux5rbkefnYzaTCxy741hkNsyk65GXXuTtTrm3ODMTiMipDD9kNszEubu+i9zd2XfOuwfSbsfUu8yGOf56dBfevJ7efX0lv5mVftdFnu3YOw9aPKvqW7sdVe8yG2aCZ1VbSdJc/Cq/3R2+ZqZ5hWtmPGu34+pdZsNwRaQicg+E3BWReyDkrojcAyF3SXHVXtdnVata5HG/czS5R3UisqbXzFS3yON+53hyj+hpptpeEVnZIo/7nSPKPRp1vt69okUej84hIvaQexhCh4jYQ+5BKB0iYg+5hyB1r2KP1IYhd4QltWHIHWFJbRhyR1hSGyaa3Hmoqkppw8STOyciVQltmIhy52kmVTobJqbcuYhAlcyGIXeEJ7NhyB3hyWwYckd4MhuG3BGezIYhd4Qns2HIHeHJbBhyFyXyrLsfMhuG3DXF9NJsoQ1D7pLieuMNnQ1D7op4W6VAYsq94VT1zb0i90Diyb0xUM2394rcA4kl98awKlbAK3IPJJLcG404e696PTyR2SLkrimq2snd87fcb/ar4Bm5B0HukjiYCSOK3A/ULnP3TomHqoGQuyJyD4TcFZF7IOSuiNwDIXdJcdVO7p6/ZWS1cyIyEHIXFVPt5O77e8ZWe1xktshR6/H1be+LDIXcpclskYPr8W+f/n3/1u7Hj700RfFcEYl9ZDbJ/vW4N+d6OXe7/8npz06+yBkhdl0yG2XferjaH/vNJxun3nefPbxYo9zd+8wSuyaZzbJvPVaL0Hdvzj2b1i13ofdVxijR3B9ebLxS3Np991ztcte5VzFKZsPsz32v7xvnbpM7vJDZMKPrsXt1qO+b3/pvcocPMhtm33rcGBzMOFtP1enMTCp0r2KUzIbZvx4fn76298lWg9zhgcyGObAet57/vb2nlrbIHR7IbJgx6/HvdXlWtfjOKvcqRslsmEguEet/Z5V7FaNkNswh63Hr+aee+s618n+bcpEzIHOvYpTMhildj/vfLq4+eXyqSyLJHfvIbJiy9Xh4sdF4+juf/u0LU52HJHfsJ7NhytZjtfFbxW59d/VZT4ucDZl7FaNkNkzJeuxefRT5vW/V6cxMVJeI8eK9EErW4+HvfFZy80SLnIm2yz2WRHhpdhBle/c/ftR4nZ5mahe5x5EIb7wRRumx++Bg5ubcE54WGV57kHsMifC2SoGUrce9uTPv/cN/fvqnc41TP/K0yPBqmHvJu0EdX9UrPxGZ1S1dj+IFq43GqVfK/nWqRQZH7sJkVrd8PXZvPpnFfq4+b7xRy9wPF9UwqXzuaos8jtgeqsYzTD1yn+ZqyDGLDCqyE5ERDSOe+7/Ouatl7r/79FQXifE0kw9RDSOd+9bg4rCtGp2ZiW2HqJOIBzKzlF5EcOa94jjm4cX6nHeP7XBXJxEPZGY58iKCOr3xRmwnM3QS8UBmliNzr9N7RJK7MJlZSi8iGLyT2NWpXuBB7l7IJOKBzCzlFxGc+680/fqTuUZjmqdVyd0LmUQ8kJmldD22+hcRNKZ5dQcPVf2QScQDmVnK1+Prj7PgTz0z3WuzORHphUwiHsjMEs9FBJE9M6OTiAcys8SUu8696kNMw8jMcsjBzCcvPPX0d3mfmSrFNIzMLKXrcaP/SPVMva6Z0blXfYhpGJlZytYjq/3Mi59++ncvTPUGwOTuR0zDyMxSfs1Mf69+/2qNrplJhe5VH2IaRmaWsosIfvvRdZD3fqM2FxHk31nlXvUhpmFkZjn6jTdq9T4zQveqDzENIzNL6fXujy4d2HLXzEzaPLl7EdMwMrOUv5qpOJrZvfWUu3Fzwges5O5FTMPIzFJ27H5x33s8kHsVYhpGZpbydwAm9+rFNIzMLKXH7qdHnl7iYKYSMQ0jM0vZejz8k5EXdfBQtRIxDSMzC5eIqYppGJlZyF1VTMPIzBJT7lzvrkpmlprlfqI3zVW5z4+nZqt7JJlZyF1VzVb3SDKz1Cz3w8X2Cy+iOjIjd98iyz2u15mTu29x5R7Zu4iQu29R5R7be0SRu3cR1U7uocSTe0y/eZfcA4ko94h+rzq5BxJT7hHhoWoY5K6JE5FBkLsonmYKgdxVySTigcws5K5KJhEPZGYhd1UyiXggMwu5q5JJxAOZWchdlUwiHsjMQu6qZBLxQGaWmHKP51lIRyYRD2RmiSj3iK6ZcWQS8UBmlnhyj+mKyLT/MsWqV8IXmUmiyT2q693Ter689jA6k5C7oPq+nryM0iTkrqfO759wgNYo5K4nptzFZokm93geqtb77XH2ERslntyjOREZU+5qs0SUeyRPMx0opPJGTkBtlJhyj0NMucvNQu5q5BI5AblZyF2NXCInIDcLuauRS+QE5GYhdzlihZwEuWMcsUJORG0WctejVciJkDvG0SrkZMRmIXdBUoWcDLljrLZMHycmVTu5S8rfEbURybtE6sRO7poie8NrldjJXVNkufNaVRyJ93cPg9w18f7uQZC7KN7fPQRyVyWTiAcys5C7KplEPJCZJabc4zmT4cgk4oHMLBHlHstLs/tkEvFAZpZ4co/mjTf6ZBLxQGaWaHKP6G2VCjKJeCAzyyTr0b2cNN8ZfHL3+8n5Tpr21pNksTP1Iv0hd2Eys0ywHt0rnd7nyXJ+u9dqLn7lbqyd7/Q+uDDtIj0id2Eysxx/PXpfuj9aedo7S/PX87/cbq5kPwcLy9Mt0idyFyYzy4Tr0Wtdyv90lTtr+QFNa2T3zkNVL2QS8UBmlgnXo7vo/txOLhWf7izloa/Nb0y/SG/iql0nEQ9kZploPXp3Xv3QfWjN/1XxqLW7kHe/2d/Zn83xNJMXMol4IDPLJOuxs5Qkbr++s/TcP6e9tezmvtwnXyQOJZOIBzKzTLYe36wn2XFLEXn2cHWjn7vGwUxkZBLxQGaWSddjLduRDyJvrkgdu0dGJhEPZGaZdD3cmcd+5JvzG72WzpmZ2Mgk4oHMLBPn7vou9uZrF5TOu0dHJhEPZGY5/np0F968nt593T0o3VnKos8fn2Y79s6DlsKzqtGRScQDmVkmeFa1lST9KwfS3k+S5I38edXeetK8onDNTHRkEvFAZpZoroiMjkwiHsjMQu6qZBLxQGYWclclk4gHMrOQuyqZRDyQmYXcVckk4oHMLOSuSiYRD2RmIXdVMol4IDMLuauSScQDmVnIXZVMIh7IzELuqmQS8UBmFnJXJZOIBzKzkLsqmUQ8kJmF3FXJJOKBzCzkrkomEQ9kZiF3VTKJeCAzC7mrkknEA5lZyF2VTCIeyMxC7qpkEvFAZhZyVyWTiAcys5C7KplEPJCZhdxVySTigcws5F6dxklUvfITkVldcq8Ouc8cuSM8coch5A5DyB2GkDsMIXcYQu4whNxxtKh+jSC540hx/ZJYcg8gokAi+xXg5O5fRIG023H1Tu7exRQIuQcSTe5RFRLVMCm5+xdVIVENk5K7f1EVEtUwKbn7F1UhUQ2TknsAMQVC7oHEkzsnInWRewDx5EHugcSUezzIPRBylxRX7eSOo0VVO7ljjJhqJ3dYQu4whNxhCLnDEHKHIeQOQ8gddrQbDZGTquSO0Noud43eyR2BtYvcJXond4TVHuSu0Du5IyxyhyHkDkPIHZbwUBWWcCISlvA0EyzhIgIYQu4whNxhCLnDEHKHIeQOQ8gdhpA7DCF3GELuMITcYQi5wxByhyHkDju4ABh28PIO2MGL92AHL82GIeQOQ8gdhpA7LOGhKizhRCQs4WkmWMJFBDCE3GEIucMQcoch5A5DyB2GkDsMIXcYQu4whNxhCLnDEHKHIeQOQ8gdhpA7DCF3GELuMITcYQi5wxByhyHkDkPIHYaQOwwhd8SlcRKzW8taLBLyyB0QQ+4whNxhCLnDEHKHIeQOQ8gdhpA7DCF3GELuMITcYQi5wxByhyHkLkrkt6pHhtw1tdv0HgC5S2q36T0EclfUbtN7EOSuiNwDIXdF5B4IuSsi90DIXRK1h0Humqg9CHIXRe0hkDsMIXcYQu4whNxhCLkjOJ2H3eSO0IROqpI7AlN6yozcEZbUBRHkjrDIHYbUNvfu5aT5zqNPFpbdh956kix2pl4kolfX3LtXOr3Pk+Xik16ruLV2vtP74MK0i4QBQrVP0GbvS/dHq5/29kKe+3Zz5dGOfvJFwgSd2idts9e6lH/cefvnee7Zzn3oZ2CqRSJ6MrVP2mZ3sfi4vrztct9ZykNfm9+YfpHAzEzUZu/Oqx/mN7YX0zz37kK+s990hzSZszlyh6pJ2txZSpLE9b3z9kZp7pMvEpilydr8Zj1xxy2bWenDuXMwg3qYtM21bEeeH8Bz7I76mbRNd+ZxMyk0V3otzsygRibO/Xz/KdRtzrujdo7fZnfhzevp3dcHD0qL3LMde+dBi2dVUQ8TPKvayg5fFr8afFrk7q6ZaV7hmhnUA1dEwhByhyHkDkPIHYaQOwwhdxhC7jCE3GEIucMQcochIXKvztkKv7d3MQ1T4Syhc6/Q2apXwKeYhlGZhdxlxTSMyizkLiumYVRmIXdZMQ2jMgu5y4ppGJVZ4sodOBK5wxByhyHkDkPIHYaQOwyxkfuDn7y2Mf6rVK3PX696FSZy+L1d+SQ1y307Sfrvb9PKbp3vjPv6ws5SMi+Xez5BsnzwHw7MWHkkYxWz5C4N3dt6k9Qs9zS9s9B/d+2dP1gp/YKflYW9ppe7+4U/i+X/UDpjd6F5pVM6nIKdpXzf0/vcvSX03r2tNkntck/X+vuO3p+X3mHd0v+RSubef7vwEmUz/mzj7uXksP+gcv3c052/TEfubbFJ6pf7+h8WBzHlufdapWHXLPejZ1Q0yD03dG+LTVLD3FfWEvcerMUd2L2cJG92smPD+Y3smPH8L91BYvOjL763/IuF8x33S1+L3/qqnvvemuZGZswf+fW+eO1f1pPnVg5+rYZ+7r/KD1mGcz9qkvTB95P+rRmpY+5Z3Jf6d+D2G9fTuy5st1N/4O5yd1evJckffbQ5v7GWPTLaTEaPJoUM5b63prnhGYtHfmvunWe7CxcOfq2GIvfejw/mfsQk7g54cLns4Xoodczd3W+X8juwuHvdbxRx93D+yxXyu3o7ryH/fJCIdO5Da5obnrG/8o8G3P+1GvLf2+V+w4X7ZCT3MZNko8xw29Qy9+wuSpbdHZh9TIrTeftzH/xy7y8Wkhrknu6taW54xv2R7P9aDYfv3Q+fpPiZ7bWaszucqWfuWc/Nj1zurw7uqdLce+vNK/9Th7370Jrmhmc8kPu+r9Vw+LF7eugk28XP7NoMj2Zqmnt28Np8Y2MomLLc63Iw86uVkoOZdDBjXQ5mDjkzc8Qk3YX8v1lj736E4g4sTuhmD4Peyu6x7fKDmTwn/dx7f9EZWtPc8IwHIxn9Wg2Pcs+2xcHcyyfJtt5y+ugIbSZql3vvx8X/+ooT7Nv5oXt2azP5Qe+L7yXnO9m+4p86xYmLbnEu8sLd68Udq2a7OHZduzC0pvk/jM6Yr3x+hLuzNL+x/2tFDHK/89pGOnRvHzlJtvXcSaYZ7txrl/tmUXfqnpZ2H+5eTpI3sg2/czl585etxa+yGp5bWetfT/OLhWTxf1vNH+SPaMXO3A1dZ7K8t6b5v4zOmK/8W+4XY/31Uv73I1+rYeiamQvp0L09ZpL8WZM3ZvljW7fcgRMgdxhC7jCE3GEIucMQcoch5A5DyB2GkDsMIXcYQu46br176kdVr0PkyF3G6lyD3AMjdx0PL5J7YOSug9yDI3cd5B4cuesg9+DIvVLuZMytbzcaz9xOi9zvv9v/JHW3Gk9fczfvfbtx5v2tV/L/IPviM/xQTIvcq+ROxvz+S+nux43Hb+e5f/fF27urjSeyf7o39/i19Gbj9GfZzV9/332Jy/3G6WvprblTr1S94nVF7pV6eLHxcvZh92rj2fyT7M8sdNf4DXc7+/us7NUn8i95xYXvduw38h8OTIHcKzU4XN9yBfc/KT5suZ+Dfu75X7uDmdW883tzHONPidwrNcg9L3gkd+c/nm+43G80Tp3Ld+dZ/X0czUyH3Cs1SDv/uC/3m0+eeS/fu+eVP3PN/QtHMSdD7pU6PPfdq6de7h/MuPIbjfwL3FE9pkfuldrLPQt5JPfVvYeqzs257Og++xHgoP1EyL1Se8fuT6QjuQ928S73n342+NvV/jmZrR9WudI1Ru6V6p97LE6+HJb7avEl2f7/3lzjTHYMf/93OaaZDrlXKsvdHaL/TX72PYvZhf1/c42X3MHMr92+/272N/d+uNo4dzu9Nef+7UZxYubZile7tsi9UtlO/L3BZQGrLuRTf3bRfTj9WbZjP/Xi7RuNM++nP/3HT+Yaj72c/wf5RQTvV7vSNUbuleKqsNki90qR+2yRe6XIfbbIvVL9R6eYEXKv0MP8YSn799khdxhC7jCE3GEIucMQcoch5A5DyB2GkDsMIXcYQu4whNxhCLnDkP8HbuGbibbbaXwAAAAASUVORK5CYII=" width="60%" style="display: block; margin: auto;" /></p>
<p>The large black dots and error bars show the predicted mean and 95% density intervals, while the small red dots show the actual data points.</p>
</div>
<div id="turning-a-custom-family-into-a-native-family" class="section level2">
<h2>Turning a Custom Family into a Native Family</h2>
<p>Family functions built natively into <strong>brms</strong> are safer to use and more convenient, as they require much less user input. If you think that your custom family is general enough to be useful to other users, please feel free to open an issue on <a href="https://github.com/paul-buerkner/brms/issues">GitHub</a> so that we can discuss all the details. Provided that we agree it makes sense to implement your family natively in brms, the following steps are required (<code>foo</code> is a placeholder for the family name):</p>
<ul>
<li>In <code>family-lists.R</code>, add function <code>.family_foo</code> which should contain basic information about your family (you will find lots of examples for other families there).</li>
<li>In <code>families.R</code>, add family function <code>foo</code> which should be a simple wrapper around <code>.brmsfamily</code>.</li>
<li>In <code>stan-likelihood.R</code>, add function <code>stan_log_lik_foo</code> which provides the likelihood of the family in Stan language.</li>
<li>If necessary, add self-defined Stan functions in separate files under <code>inst/chunks</code>.</li>
<li>Add functions <code>posterior_predict_foo</code>, <code>posterior_epred_foo</code> and <code>log_lik_foo</code> to <code>posterior_predict.R</code>, <code>posterior_epred.R</code> and <code>log_lik.R</code>, respectively.</li>
<li>If necessary, add distribution functions to <code>distributions.R</code>.</li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
